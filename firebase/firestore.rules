rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /timer-sets/{timerSetId} {
      function isMember() {
        return request.auth != null && (
          request.auth.uid == resource.data.owner
          || !resource.data.password
          || resource.data.password == get(/databases/$(daetabase)/timer-sets/$(timerSetId)/members/$(request.auth.uid)).data.password
        )
      }

      allow write, read: if isMember();

    	match /timers/{timerId} {
      	allow read, write: if isMember();
    	}
    }
  }
}
